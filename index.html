function updateChart(data, startYear, endYear, dataType, scaleType) {
  const svg = d3.select("#chart");
  svg.selectAll("*").remove();

  const width = +svg.attr("width");
  const height = +svg.attr("height");
  const margin = { top: 20, right: 30, bottom: 50, left: 50 };
  const innerWidth = width - margin.left - margin.right;
  const innerHeight = height - margin.top - margin.bottom;

  const filteredData = data.filter(d => {
    const year = d.Date.getFullYear();
    return year >= startYear && year <= endYear;
  });

  if (filteredData.length === 0) {
    svg.append("text")
      .attr("x", width / 2)
      .attr("y", height / 2)
      .attr("text-anchor", "middle")
      .text("No data available for the selected period.");
    return;
  }

  const xScale = d3.time.scale()
    .domain(d3.extent(filteredData, d => d.Date))
    .range([0, innerWidth]);

  let yScale;
  let yAxis;

  if (scaleType === "linear") {
    yScale = d3.scale.linear()
      .domain([0, d3.max(filteredData, d => d[dataType])])
      .range([innerHeight, 0])
      .nice();
    
    yAxis = d3.svg.axis()
      .scale(yScale)
      .orient("left")
      .ticks(6)
      .tickFormat(d3.format(".2f")); // Format for linear axis to show decimals
  } else {
    yScale = d3.scale.log()
      .domain([Math.max(0.01, d3.min(filteredData, d => d[dataType])), d3.max(filteredData, d => d[dataType])])
      .range([innerHeight, 0])
      .nice();

    const logTicks = generateLogTicks(d3.min(filteredData, d => d[dataType]), d3.max(filteredData, d => d[dataType]));

    yAxis = d3.svg.axis()
      .scale(yScale)
      .orient("left")
      .tickValues(logTicks)
      .tickFormat(function(d) {
        if (d < 1) {
          return d3.format(".2f")(d); // Show two decimal places for values <1
        }
        return d3.format(".0f")(d); // Otherwise, show integer ticks
      });
  }

  const xAxis = d3.svg.axis().scale(xScale).orient("bottom");

  const g = svg.append("g")
    .attr("transform", `translate(${margin.left},${margin.top})`);

  g.append("g").attr("class", "y axis").call(yAxis)
    .append("text")
    .attr("transform", "rotate(-90)")
    .attr("y", -40)
    .attr("x", -innerHeight / 2)
    .style("text-anchor", "middle")
    .attr("class", "axis-label")
    .text(dataType === "Volume" ? "Volume" : "Stock Price");

  g.append("g").attr("class", "x axis")
    .attr("transform", `translate(0,${innerHeight})`)
    .call(xAxis)
    .append("text")
    .attr("x", innerWidth / 2)
    .attr("y", 40)
    .style("text-anchor", "middle")
    .attr("class", "axis-label")
    .text("Date");

  // Add vertical grid lines
  g.selectAll(".x-grid-line")
    .data(xScale.ticks(10))
    .enter().append("line")
    .attr("class", "grid-line")
    .attr("x1", d => xScale(d))
    .attr("x2", d => xScale(d))
    .attr("y1", 0)
    .attr("y2", innerHeight);

  const line = d3.svg.line()
    .x(d => xScale(d.Date))
    .y(d => yScale(d[dataType]));

  g.append("path")
    .datum(filteredData)
    .attr("class", "line")
    .attr("d", line);
}
